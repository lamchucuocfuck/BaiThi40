<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>List</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
        integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />


    <!-- Bootstrap CSS CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
        integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/src/user/css/userList.css">

    <!-- Font Awesome -->
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/solid.js"
        integrity="sha384-tzzSw1/Vo+0N5UhStP3bvwWPq+uvzCMfrN1fEFe+xBmv1C/AtVX5K0uZtmcHitFZ"
        crossorigin="anonymous"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/fontawesome.js"
        integrity="sha384-6OIrr52G08NpOFSZdxxz1xdNSndlD4vdcf/q2myIUVO0VsqaGHJsB0RaBE01VTOY"
        crossorigin="anonymous"></script>

</head>

<body>
    <div class="wrapper">
        <!-- Sidebar  -->
        <nav id="sidebar">
            <a href="/src/home.html"><img width="100%" src="/img/Hand-Drawn-Farm-Products-Logos-Free-Vector.jpg" alt=""></a>

            <ul class="list-unstyled components">
                <li>
                    <a href="/src/home.html"><i class="fa-solid fa-house pr-2"></i>Trang Chủ</a>

                </li>

                <li class="active">
                    <a href="#homeSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle"><i class="fa-solid fa-list-check pr-2"></i>Quản Lý
                        Người Dùng</a>
                    <ul class="collapse list-unstyled" id="homeSubmenu">
                        <li>
                            <a href="/src/user/userList.html"> <i class="fa-solid fa-list pr-2"></i>Danh Sách Người Dùng</a>
                        </li>
                        <li>
                            <a href="/src/user/createUser.html"><i class="fa-solid fa-plus pr-2"></i>Thêm Người Dùng Mới</a>
                        </li>
                    </ul>
                </li>
                <li class="active">
                    <a href="#homeSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle"><i class="fa-solid fa-list-check pr-2"></i>Quản Lý
                        Mùa Vụ</a>
                    <ul class="collapse list-unstyled" id="homeSubmenu">
                        <li>
                            <a href="/src/farm/seasonList.html"><i class="fa-solid fa-list pr-2"></i>Danh Sách Mùa Vụ</a>
                        </li>
                        <li>
                            <a href="/src/farm/createSeason.html"><i class="fa-solid fa-plus pr-2"></i>Thêm Mùa Vụ Mới</a>
                        </li>

                        <li>
                            <a href="/src/farm/reportSeason.html"><i class="fa-solid fa-address-book pr-2"></i>Thống Kê & Báo Cáo</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="/src/map.html"><i class="fa-solid fa-id-card pr-2"></i>Liên Lạc</a>
                    
                </li>
                <li>
                    <a href="/src/404.html"><i class="fa-solid fa-exclamation pr-2"></i>404</a>
                </li>
            </ul>

        </nav>
        <!-- Page Content  -->
        <div id="content">
            <!-- <nav class="navbar navbar-expand-lg ">
                <button type="button" id="sidebarCollapse" class="btn btn-info d-md-none">
                    <span></span>
                    <i class="fas fa-align-left"></i>
                </button>
            </nav> -->
            <table class="table" id="tbAct">

                <thead>
                    <tr>
                        <th scope="col">ID</th>
                        <th scope="col">Tên</th>
                        <th scope="col">UserName</th>
                        <th scope="col">Pass</th>
                        <th scope="col">Image</th>
                        <th scope="col">Edit</th>
                    </tr>
                </thead>

                <tbody id="tbody">
                </tbody>

            </table>
        </div>
        <div id="edit" class="myList">
            <div class="modal-content">
                <span class="close"> &times; </span>
                <form>
                    <div class="form-group">
                        <input disabled type="text" name="" id="txtID" placeholder="ID" class="form-control">
                    </div>
                    <div class="form-group">
                        <input type="text" name="" id="txtNameedit" placeholder="Name" class="form-control">
                    </div>
                    <div class="form-group">
                        <input type="text" name="" id="txtuserAdd" placeholder="UserName" class="form-control">
                    </div>
                    <div class="form-group">
                        <input type="text" name="" id="txtpass" placeholder="Password" class="form-control">
                    </div>
                    <div class="form-group">
                        <input type="url" name="" id="txtimg" placeholder="Image" class="form-control">
                    </div>
                    <div class="form-group d-flex justify-content-end">
                        <button type="button" class="btn btn-primary close-modal" id="btnUpdate">Update</button>
                        <button type="button" class="btn btn-secondary close-modal" id="btnCancel">Cancel</button>
                    </div>
                </form>
            </div>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
            integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF"
            crossorigin="anonymous"></script>
        <script>

            $(document).ready(function () {
                $('#sidebarCollapse').on('click', function () {
                    $('#sidebar').toggleClass('active');
                });
            });

            $(".close").click(function () {
                $("#edit").hide()
            })
            $("#btnCancel").click(function () {
                $("#edit").hide()
            })

            loadData();

            function loadData() {
                $("#tbAct tbody").empty();
                var activity = "";
                $.ajax({
                    url: "https://627dc890b75a25d3f3abaa73.mockapi.io/user",
                    type: "GET",
                    success: function (result) {
                        array = result;
                        for (var i = 0; i < result.length; i++) {
                            activity = activity + '<tr><th scope = "row">' + result[i].id + '</th>' +
                                '<td>' + result[i].name + '</td>' +
                                '<td>' + result[i].username + '</td>' +
                                '<td>' + result[i].pass + '</td>' +
                                '<td>' + result[i].avt + '</td>' +
                                "<td>" +
                                '<img class="actionIcon mr-2" style="width: 20px; height: 20px; cursor: pointer" class="" src="http://cdn.onlinewebfonts.com/svg/img_194863.svg" onclick = edit(' + result[i].id + ')>' +
                                '<img class="actionIcon" style="width: 20px; height: 20px; cursor: pointer" class="" src="http://cdn.onlinewebfonts.com/svg/img_416864.png" onclick = "Delete(' + result[i].id + ')">'
                            "</td></tr>"
                        }
                        console.log(result)
                        $("#tbAct tbody").append(activity);
                    }
                })
            }

            function edit(id){
          // diem du lieu vao form
            for (var i = 0; i < array.length; i++){
                if (array[i].id ==id) {
                  alert("Bạn có muốn sửa?");
                  $("#txtID").val(array[i].id);
                  $("#txtNameedit").val(array[i].name);
                  $("#txtuserAdd").val(array[i].username);
                  $("#txtpass").val(array[i].pass);
                  $("#txtimg").val(array[i].avt);
                
                $("#edit").show();
                  break;
              }
          }
         
      }
             // update du lieu
        $("#btnUpdate").click(function(){
            // lay du lieu
                var udt = {};
                var id = $("#txtID").val();
                udt.name = $("#txtNameedit").val();
                udt.username = $("#txtuserAdd").val();
                udt.pass = $("#txtpass").val();
                udt.avt = $("#txtimg").val();
                // gui du lieu len server
                $.ajax({
                    url: "https://627dc890b75a25d3f3abaa73.mockapi.io/user/" + id,
                    type: "PUT",
                    data: udt,
                    success: function(result){
                        alert("Sua thanh cong");
                        $("#edit").hide();
                        loadData();
                    }
                })
        });
        function Delete(id) {
            $.ajax({
                url: "https://627dc890b75a25d3f3abaa73.mockapi.io/user/" + id,
                type: "DELETE",
                success: function () {
                    $("#tbody").empty();
                    loadData();

                }
            })
        }

        </script>
</body>

</html>